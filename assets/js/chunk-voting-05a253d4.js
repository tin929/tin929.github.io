System.register(["./chunk-vendor.js"],(function(){"use strict";var t;return{setters:[function(e){t=e.o}],execute:function(){class VoteCountElement{constructor(t){this.voteCountElement=t}ariaHide(){var t;null===(t=this.voteCountElement)||void 0===t||t.setAttribute("aria-hidden","true")}ariaShow(){var t;null===(t=this.voteCountElement)||void 0===t||t.setAttribute("aria-hidden","false")}}class VoteFormElement{constructor(t){this.voteForm=t,this.defaultVoteCountElement=new VoteCountElement(t.querySelector(".js-default-vote-count")),this.upvotedCountElement=new VoteCountElement(t.querySelector(".js-upvoted-vote-count")),this.url=this.voteForm.getAttribute("data-url")||""}isUpvoted(){return"true"===this.voteForm.getAttribute("data-upvoted")}getCsrfDeleteInputValue(){const t=this.voteForm.querySelector(".js-data-url-delete-csrf");return t?t.value:""}getCsrfPutInputValue(){const t=this.voteForm.querySelector(".js-data-url-put-csrf");return t?t.value:""}simulateUpvote(){var t,e;this.voteForm.setAttribute("data-upvoted","true"),this.voteForm.getAttribute("data-new-upvote")&&(null===(t=this.voteForm.querySelector(".js-upvote-button"))||void 0===t||t.classList.add("user-has-reacted","color-bg-info"),null===(e=this.voteForm.querySelector(".js-upvote-button"))||void 0===e||e.classList.remove("color-text-secondary")),this.voteForm.classList.add("is-upvoted"),this.defaultVoteCountElement.ariaHide(),this.upvotedCountElement.ariaShow()}simulateUpvoteDeletion(){var t,e;this.voteForm.setAttribute("data-upvoted","false"),this.voteForm.getAttribute("data-new-upvote")&&(null===(t=this.voteForm.querySelector(".js-upvote-button"))||void 0===t||t.classList.remove("user-has-reacted","color-bg-info"),null===(e=this.voteForm.querySelector(".js-upvote-button"))||void 0===e||e.classList.add("color-text-secondary")),this.voteForm.classList.remove("is-upvoted"),this.defaultVoteCountElement.ariaShow(),this.upvotedCountElement.ariaHide()}displayUpVoteError(t){const e=this.voteForm.querySelector(".js-upvote-error");e instanceof HTMLElement&&(e.textContent=t,e.hidden=!1)}hideVoteErrors(){const t=this.voteForm.querySelector(".js-upvote-error");t instanceof HTMLElement&&(t.hidden=!0)}}class Upvote{constructor(t){this.voteFormElement=t}animateUpvote(t){t?this.voteFormElement.simulateUpvoteDeletion():this.voteFormElement.simulateUpvote()}animateUpvoteUndo(t){t?this.voteFormElement.simulateUpvote():this.voteFormElement.simulateUpvoteDeletion()}async click(){this.voteFormElement.hideVoteErrors();const t=this.voteFormElement.isUpvoted(),e=t?this.voteFormElement.getCsrfDeleteInputValue():this.voteFormElement.getCsrfPutInputValue(),o=t?"delete":"put";this.animateUpvote(t);const r=await(async(t,e,o,r)=>{const s=new FormData;return!0===r&&s.append("upvote","true"),await fetch(t,{body:"delete"===o?"":s,method:o,mode:"same-origin",headers:{"Scoped-CSRF-Token":e}})})(this.voteFormElement.url,e,o,!t);if(!r.ok){const e=await r.json();this.voteFormElement.displayUpVoteError(e.error),this.animateUpvoteUndo(t)}}}t(".js-upvote-button",(t=>{if(!(t instanceof HTMLElement))return;if(!(t.parentElement instanceof HTMLElement))return;const e=new Upvote(new VoteFormElement(t.parentElement));t.addEventListener("click",(async()=>{await e.click()}))}))}}}));
//# sourceMappingURL=chunk-voting-c9814897.js.map
